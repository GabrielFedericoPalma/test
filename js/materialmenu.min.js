!function(window){"use strict";function whichTransitionEvent(){var t,el=document.createElement("fakeelement"),transitions={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in transitions)if(void 0!==el.style[t])return transitions[t]}var transitionEvent=whichTransitionEvent();function getPosition(e){var posx=0,posy=0;if(!e)var e=window.event;return e.pageX||e.pageY?(posx=e.pageX,posy=e.pageY):(e.clientX||e.clientY)&&(posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:posx,y:posy}}function getOffsetRect(elem){var box=elem.getBoundingClientRect(),body=document.body,docElem=document.documentElement,scrollTop=window.pageYOffset||docElem.scrollTop||body.scrollTop,scrollLeft=window.pageXOffset||docElem.scrollLeft||body.scrollLeft,clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{x:Math.round(left),y:Math.round(top)}}function Menu(){this.body=document.body,this.wrapper=document.querySelector(".wrapper"),this.toggle=document.querySelector("#mm-menu-toggle"),this.menu=document.querySelector("#mm-menu"),this.menuItems=this.menu.querySelectorAll("li"),this.menuItemLinks=this.menu.querySelectorAll("a"),this.menuPosition="off",this.mask=document.createElement("div"),this.mask.className="mm-menu-mask",document.body.appendChild(this.mask),this._init()}Menu.prototype._init=function(){this._initToggleEvents(),this._initItemTransitions(),this._initTouchEffect(),this._initMaskEvents()},Menu.prototype._initToggleEvents=function(){var scope=this;this.toggle.addEventListener("click",function(){"off"==scope.menuPosition?scope._toggleMenuOn():scope._toggleMenuOff()})},Menu.prototype._toggleMenuOn=function(){var scope=this;this.body.classList.add("mm-menu-open"),this.wrapper.classList.add("mm-menu-open"),this.toggle.classList.add("active"),this.menu.classList.add("active");for(var i=0;i<this.menuItems.length;i++){var item;!function(item){item.classList.add("in-view")}(this.menuItems[i])}this.mask.classList.add("active"),this.menuPosition="on"},Menu.prototype._toggleMenuOff=function(){var scope=this;this.body.classList.remove("mm-menu-open"),this.wrapper.classList.remove("mm-menu-open"),this.toggle.classList.remove("active"),this.menu.classList.remove("active");for(var i=0;i<this.menuItems.length;i++){var item;!function(item){item.classList.remove("in-view")}(this.menuItems[i])}this.mask.classList.remove("active"),this.menuPosition="off"},Menu.prototype._initItemTransitions=function(){for(var scope=this,num=this.menuItems.length,transitionDelay=.1,i=0;i<num;i++){var menuItem=this.menuItems[i],delay=transitionDelay+"s";this._itemTransitionHandler(menuItem,delay),transitionDelay+=.1}},Menu.prototype._itemTransitionHandler=function(menuItem,delay){menuItem.style.webkitTransition="opacity 0.5s "+delay+" ,transform 0.5s "+delay,menuItem.style.MozTransition="opacity 0.5s "+delay+" ,transform 0.5s "+delay,menuItem.style.transition="opacity 0.5s "+delay+" ,transform 0.5s "+delay},Menu.prototype._initTouchEffect=function(){for(var num=this.menuItemLinks.length,i=0;i<num;i++){var menuItemLink=this.menuItemLinks[i];this._touchEffectHandler(menuItemLink)}},Menu.prototype._touchEffectHandler=function(menuItemLink){var elWidth=menuItemLink.offsetWidth,elHeight=menuItemLink.offsetHeight,touchEffectSize=2*Math.max(elWidth,elHeight),touchEffectElement=document.createElement("span");touchEffectElement.className="mm-menu__link--touch-effect",touchEffectElement.style.width=touchEffectSize+"px",touchEffectElement.style.height=touchEffectSize+"px",menuItemLink.insertBefore(touchEffectElement,menuItemLink.firstChild),menuItemLink.addEventListener("click",function(e){var relX=getPosition(e).x-getOffsetRect(this).x,relY=getPosition(e).y-getOffsetRect(this).y;touchEffectElement.style.top=relY+"px",touchEffectElement.style.left=relX+"px",touchEffectElement.style.marginTop=-touchEffectSize/2+"px",touchEffectElement.style.marginLeft=-touchEffectSize/2+"px",touchEffectElement.classList.add("animating")}),touchEffectElement.addEventListener(transitionEvent,function(){this.classList.remove("animating")})},Menu.prototype._initMaskEvents=function(){var scope=this;this.mask.addEventListener("click",function(e){e.preventDefault(),"on"==scope.menuPosition&&scope._toggleMenuOff()})},window.Menu=Menu}(window);